* Building

** Pre-requisites

** Cabal
:PROPERTIES:
:header-args: :tangle "test-cabal.sh" :tangle-mode (identity #o755) :noweb yes
:END:

#+NAME: ghc-options
#+BEGIN_SRC sh :tangle no
--ghc-options "-O0 -Wall -j8 +RTS -A256m -n4m -RTS"
#+END_SRC

#+BEGIN_SRC sh :results code :wrap SRC sh :noweb yes
cabal update
#+END_SRC

#+BEGIN_SRC sh
cabal <<ghc-options>> build lib:cardano-wallet-core
#+END_SRC

You can use ~cabal build all~ to build the entire project.

#+BEGIN_SRC sh
cabal <<ghc-options>> run cardano-wallet:exe:cardano-wallet -- --help
#+END_SRC

#+BEGIN_SRC sh
cabal <<ghc-options>> build cardano-wallet:exe:cardano-wallet -frelease
#+END_SRC

#+BEGIN_SRC sh
cabal configure --enable-tests --enable-benchmarks
#+END_SRC

To run one of the unit test suites:
#+BEGIN_SRC sh
cabal <<ghc-options>> test cardano-wallet-core:test:unit --test-options "--match \"Data.Vector.Shuffle/shuffle/every non-empty list can be shuffled, ultimately\""
#+END_SRC

To run the entire test suite, remove the "--test-options" option.

To run one of the DB benchmarks:
#+BEGIN_SRC sh
cabal <<ghc-options>> bench cardano-wallet-core:bench:db --benchmark-options "SeqState"
#+END_SRC

To run all the benchmarks, remove the "--benchmark-options" option.

To run part of the integration test suite:
#+BEGIN_SRC sh
cabal <<ghc-options>> test cardano-wallet:test:integration --test-options "--match CLI_VERSION -j8"
#+END_SRC

To run the entire integration test suite, remove the "--test-options" option.

6. Install binaries from `./dist-newstyle/` into a system location:

#+BEGIN_SRC sh
cabal install all --install-method=copy --installdir=/usr/local/bin
#+END_SRC
